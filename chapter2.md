## 第 2 章 Web アクセシビリティの基礎

### 2-1. 基礎となるマシンリーダブルを理解する

- アイコンのみのボタンはコンテンツやセマンティクス（意味）を読み取れることが重要
- [読み上げられる実装](https://kitta81.github.io/accessibility/readable/button/) と[読み上げられない実装](https://kitta81.github.io/accessibility/nonreadable/button/) がある
  - 読み上げられる
    - button タグを使用
    - 画像には img タグを使用して、alt を属性を付与
  - 読み上げられない
    - div タグを使用
    - 画像は svg タグ
- チェックボックスも選択したかどうかが分からないケースもある
  - input タグを使って、type="checkbox" checked="cheked"を付与してやれば OK
  - span タグだけで作ると、チェックボックスであることや、チェックされていることが読み取れない
- WAI-ARIA で補完する
  - HTML の要素や属性には限りがあり、アプリケーション独自のセマンティクスが不足する
  - それを補完するのが WAI-ARIA
    - 役割を補完する WAI-ARIA ロール
    - 状態やプロパティを補完する WAI-ARIA ステート、プロパティ
  - タブ UI をは HTML ネイティブだけでは構成できない
    - WAI-ARIA で表現することが可能
  - 読み上げられないボタンやチェックボックスも、WAI-ARIA で補完することが可能
    - ただし、HTML ネイティブの方が優れているので、可能な限り HTML ネイティブで実装する
      - 例えば、span タグに role="button"を付与してもキーボード操作ができない
    - あくまでも補完のために用いる
- AOM（アクセシビリティオブジェクトモデル）
  - HTML から DOM（ドキュメントオブジェクトモデル）を生成
  - CSS から CSS OM を生成
    - この 2 つから AOM を生成する
  - AOM を操作する WAI-ARIA
    - Name プロパティ
    - Role プロパティ
    - Description プロパティ
    - Expanded プロパティ
    - Check プロパティ
    - Disabled プロパティ
    - などなど
  - 優先順位
    - WAI-ARIA > CSS > HTML の順に優先される

### 2-2. キーボード操作の基本

- ブラウザ上で以下のようなことができる
  - Tab キーを押したらフォームの入力欄などにフォーカス
  - スペースキーやエンターキーを押したら実行
  - 上下左右キーで選択
- マウスは？
  - 目と手を連動しないと操作できない
  - 画面を見ることのできないユーザーには操作できない
    - スクリーンリーダー、キーボードで操作する
- メリット
  - マウスが使えない人でも操作できる
  - キーボードとマウスの持ち替えが不要で効率的、正確
    - 支援技術ユーザーにとっての負担が大きい
      - ポップアップやドロップダウンを Tab キーや上下左右キーで選択する
- よくある事例
  - インタラクティブ要素を使用していないので、キーボード操作できない
    - href を持つ a タグ
    - button
    - select
    - などなど
    - JavaScript でクリックイベントを付与しても、キーボード操作できない
      - div タグのボタン
        - WAI-ARIA で role="button"を付けてもキーボード操作できない
    - 改善例：インタラクティブ要素を使用する
    - 改善例：tabindex を使用する
  - インタラクティブ要素を使用しているけど、隠している
    - CSS で dispay: none を付与している
    - 改善例：フォーカス可能なまま、隠す
  - マウスでしか表示されない
    - マウスオーバーで表示される要素
    - 改善例：マウスイベントとキーボードイベントを併用
  - キーボード操作の現在位置がわからない
    - CSS でフォーカスを非表示にしている
    - 改善例：フォーカスを表示する（適切に出し分ける）

### 2-3. 非テキストコンテンツのマシンリーダビリティ

- 非テキストとは
  - 画像
  - グラフ
  - アイコン
  - などなど
- よくある事例
  - 代替テキストが付与されていない画像
    - img タグを使っていて alt 属性がない
    - svg も同じ
    - 改善策：alt 属性を付与、role 属性や、aria-label でも可
  - アクセシブルな名前のない UI
    - ボタンであることはわかるが、何をするボタンなのかわからない
    - input タグを使用して、テキスト入力であることはわかるが、何を入力するのかわからない
    - 改善策：アクセシブルな名前をつける
      - テキストの付与（これがベスト）
      - label タグの使用
      - aria-label 属性の付与
  - 装飾のための視覚表現がテキストデータを持っている
    - 今までの例と逆
    - 装飾のための svg タグに title 要素が設定されている
    - ユーザーにとってノイズになる
    - 改善策：視覚表現を無視する
      - 背景画像を使用する
      - alt 属性を空にする
      - aria-hidden 属性を使用する
- チェック方法
  - 画像
    - 代替テキスト（alt 属性）の付与
  - UI
    - devtools でチェックできる
  - eslint のルール

### 2-4. コンテンツ構造のマシンリーダビリティ

- データテーブルなど、構造を持っているコンテンツ
  - 見出しセルがある
  - 行でグルーピングされている
- よくある事例
  - 見出しが見出しとしてマークアップされていない
    - 見出しに h1~h6 タグを使用していない
    - 改善策：見出しを見出しとしてマークアップする
  - 情報の関係性をマークアップできていない
    - KeyValue 形式
    - 視覚的には情報の関係が分かるが、スクリーンリーダーではわからない
    - 改善策：マークアップで情報を関連付ける
      - label タグを使う
  - 情報のグループをマークアップしていない
    - 「完了 123 件」「進行中 28 件」「エラー 3 件」
    - すべて span タグで実装すると、スクリーンリーダーで確認を持てなくなる
    - 改善策：マークアップでグルーピング
      - dl タグでグルーピング
  - 視覚的な表現のために間違ったセマンティクスを使用している
    - 段組みのために table タグを使う
    - 昔はよくあったが、最近は flexbox や grid レイアウトが主流でみられない
    - ただし、HTML メールではメールクライアントの CSS 対応が遅れているので主要なレイアウトとして使用されている
    - 改善策：role~"presentation"属性を付与する
      - AOM から削除される
